var _createClass=function(){function a(b,c){for(var f,d=0;d<c.length;d++)f=c[d],f.enumerable=f.enumerable||!1,f.configurable=!0,'value'in f&&(f.writable=!0),Object.defineProperty(b,f.key,f)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}(function(a,b,c){var d=function(){function f(){_classCallCheck(this,f),this.xhr=null,this.timeout=null}return _createClass(f,[{key:'transliterate',value:function transliterate(g,h){return a.get(b.url('machine_name/transliterate'),{text:g,langcode:c.langcode,replace_pattern:h.replace_pattern,replace_token:h.replace_token,replace:h.replace,lowercase:!0})}},{key:'showMachineName',value:function showMachineName(g,h){var j=h.options;''===g?(h.$suffix.hide(),h.$target.val(g),h.$preview.empty()):(g!==j.replace&&(h.$target.val(g),h.$preview.html(j.field_prefix+b.checkPlain(g)+j.field_suffix)),h.$suffix.show())}},{key:'clickEditHandler',value:function clickEditHandler(g){var h=g.data;h.$wrapper.removeClass('visually-hidden'),h.$target.trigger('focus'),h.$suffix.hide(),h.$source.off('.machineName')}},{key:'machineNameHandler',value:function machineNameHandler(g){var h=g.data,j=h.options,k=a(g.target).val(),l=new RegExp(j.replace_pattern,'g'),m=k.toLowerCase().replace(l,j.replace).substr(0,j.maxlength);this.xhr&&4!==this.xhr.readystate&&(this.xhr.abort(),this.xhr=null),this.timeout&&(clearTimeout(this.timeout),this.timeout=null),k.toLowerCase()===m?b.behaviors.machinename.showMachineName(m,h):this.timeout=setTimeout(function(){b.behaviors.machinename.xhr=b.behaviors.machinename.transliterate(k,j).done(function(n){b.behaviors.machinename.showMachineName(n.substr(0,j.maxlength),h)})},300)}},{key:'attach',value:function attach(g,h){var j=this,k=a(g);Object.keys(h.machineName).forEach(function(l){var m='',n=h.machineName[l],o=k.find(l).addClass('machine-name-source').once('machine-name'),p=k.find(n.target).addClass('machine-name-target'),q=k.find(n.suffix),r=p.closest('.js-form-item');if(o.length&&p.length&&q.length&&r.length&&!p.hasClass('error')){n.maxlength=p.attr('maxlength'),r.addClass('visually-hidden'),p.is(':disabled')||''!==p.val()?m=p.val():''!==o.val()&&(m=self.transliterate(o.val(),n));var s=a('<span class="machine-name-value">'+n.field_prefix+b.checkPlain(m)+n.field_suffix+'</span>');if(q.empty(),n.label&&q.append('<span class="machine-name-label">'+n.label+': </span>'),q.append(s),!p.is(':disabled')){var t={$source:o,$target:p,$suffix:q,$wrapper:r,$preview:s,options:n},u=a('<span class="admin-link"><button type="button" class="link">'+b.t('Edit')+'</button></span>').on('click',t,j.clickEditHandler);q.append(u),''===p.val()&&o.on('formUpdated.machineName',t,j.machineNameHandler).trigger('formUpdated.machineName'),p.on('invalid',t,j.clickEditHandler)}}})}}]),f}();b.behaviors.machinename=new d})(jQuery,Drupal,drupalSettings);