(function(){"use strict";var a=function(c,d){if(!(c instanceof d))throw new TypeError("Cannot call a class as a function")},b=function(){function c(d,f){for(var h,g=0;g<f.length;g++)h=f[g],h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(d,h.key,h)}return function(d,f,g){return f&&c(d.prototype,f),g&&c(d,g),d}}();(function(c,d,f){var g=function(){function h(){a(this,h),this.xhr=null,this.timeout=null}return b(h,[{key:"transliterate",value:function(k,l){return c.get(d.url("machine_name/transliterate"),{text:k,langcode:f.langcode,replace_pattern:l.replace_pattern,replace_token:l.replace_token,replace:l.replace,lowercase:!0})}},{key:"showMachineName",value:function(k,l){var m=l.options;""===k?(l.$suffix.hide(),l.$target.val(k),l.$preview.empty()):(k!==m.replace&&(l.$target.val(k),l.$preview.html(m.field_prefix+d.checkPlain(k)+m.field_suffix)),l.$suffix.show())}},{key:"clickEditHandler",value:function(k){var l=k.data;l.$wrapper.removeClass("visually-hidden"),l.$target.trigger("focus"),l.$suffix.hide(),l.$source.off(".machineName")}},{key:"machineNameHandler",value:function(k){var l=k.data,m=l.options,n=c(k.target).val(),o=new RegExp(m.replace_pattern,"g"),p=n.toLowerCase().replace(o,m.replace).substr(0,m.maxlength);this.xhr&&4!==this.xhr.readystate&&(this.xhr.abort(),this.xhr=null),this.timeout&&(clearTimeout(this.timeout),this.timeout=null),n.toLowerCase()===p?d.behaviors.machinename.showMachineName(p,l):this.timeout=setTimeout(function(){d.behaviors.machinename.xhr=d.behaviors.machinename.transliterate(n,m).done(function(q){d.behaviors.machinename.showMachineName(q.substr(0,m.maxlength),l)})},300)}},{key:"attach",value:function(k,l){var m=this,n=c(k);Object.keys(l.machineName).forEach(function(o){var p="",q=l.machineName[o],r=n.find(o).addClass("machine-name-source").once("machine-name"),s=n.find(q.target).addClass("machine-name-target"),t=n.find(q.suffix),u=s.closest(".js-form-item");if(r.length&&s.length&&t.length&&u.length&&!s.hasClass("error")){q.maxlength=s.attr("maxlength"),u.addClass("visually-hidden"),s.is(":disabled")||""!==s.val()?p=s.val():""!==r.val()&&(p=self.transliterate(r.val(),q));var v=c("<span class=\"machine-name-value\">"+q.field_prefix+d.checkPlain(p)+q.field_suffix+"</span>");if(t.empty(),q.label&&t.append("<span class=\"machine-name-label\">"+q.label+": </span>"),t.append(v),!s.is(":disabled")){var w={$source:r,$target:s,$suffix:t,$wrapper:u,$preview:v,options:q},x=c("<span class=\"admin-link\"><button type=\"button\" class=\"link\">"+d.t("Edit")+"</button></span>").on("click",w,m.clickEditHandler);t.append(x),""===s.val()&&r.on("formUpdated.machineName",w,m.machineNameHandler).trigger("formUpdated.machineName"),s.on("invalid",w,m.clickEditHandler)}}})}}]),h}();d.behaviors.machinename=new g})(jQuery,Drupal,drupalSettings)})();
//# sourceMappingURL=machine-name.js.map
